[["index.html", "Making Lecture Notes with Bookdown Introduction System Requirements Caveat", " Making Lecture Notes with Bookdown Vicky Scowcroft 2022-08-22 Introduction This guide walks through how to create html lecture notes using R, Markdown and Bookdown. This format is preferred as LaTeX doesn’t play nicely with accessibility tools like screen readers, especially for maths heavy content. System Requirements To use bookdown, you will need to have R and R studio installed (perhaps R studio is not a requirement, but it makes things a lot easier). These can both be installed from the DDAT Self Service app on a Mac, or R can be downloaded directly from here and R Studio from here. You will also need pandoc. This may already be installed on your system as part of the Anaconda distribution. The bookdown package can be installed from CRAN or Github: install.packages(&quot;bookdown&quot;) # or the development version # devtools::install_github(&quot;rstudio/bookdown&quot;) Caveat The instructions in this guide are what worked for me, on a Mac using R version 4.2.1, R Studio version 2022.07.1 and pandoc version 2.18 (updated August 2022). This guide also assumes that you’re familiar with using the command line. "],["01-intro.html", "Chapter 1 Getting started", " Chapter 1 Getting started The quickest way to get started is to use the bookdown demo as a template. This page gives instructions for how to do this. The bookdown: Authoring Books and Technical Documents with R Markdown is the main documentation for bookdown. I won’t repeat a lot of the information here. This guide will walk through the steps I used to convert my LaTeX lecture notes for PH40112 to the bookdown version here. The files used to create the PH40112 notes are available on github and you’re welcome to use those as a starting point. "],["02-latex-conversion.html", "Chapter 2 Converting from LaTeX notes 2.1 Converting tex files 2.2 Batch conversion 2.3 Tidying up the Rmd file 2.4 Notes with gaps 2.5 Using the titlesec package", " Chapter 2 Converting from LaTeX notes 2.1 Converting tex files If you already have LaTeX versions of your notes you can convert these to markdown using pandoc Pandoc won’t create perfect versions of your notes - you’ll most likely have to do a bit of tweaking, but it gets most of the way there. You can convert a tex file to Rmd via the command pandoc -f latex -t markdown input-tex.tex -o output-md.Rmd where input-tex.tex is the name of your tex file and output-md.Rmd is the name of your output Rmd file. Pandoc converts one tex file at a time. It doesn’t understand how to process a “master” tex file with input or insert LaTeX commands. Each file will need to be processed separately. 2.2 Batch conversion If you want to convert a batch of latex files you can script the process. 2.3 Tidying up the Rmd file Pandoc will have done most of the work in getting your tex file converted to markdown. However, depending on how complex the original file was, you may end up with some tidying to do. Things that typically will need fixing are: Section etc labels - if you used underscores in any of your latex labels you should change these to ‘-’ in the markdown file. The underscores confuse markdown. Section 4 discusses sections, chapters, etc. Figures - the default pandoc conversion is quite limited, so here we’ll use a more adaptable figure environment. In practice its easiest to just copy-paste the example code in Chapter 5 and edit the relavent bits. Equations - the equations themselves should be fine, but if you want to have equation numbers you’ll need to do some tidying. See Chapter 6 for the syntax. Tables - tables have a different format but it’s pretty easy to convert a latex table using find/replace. See Chapter 7. References - generally easy to fix. See Chapter 8. 2.4 Notes with gaps Think carefully about whether you want to provide notes with gaps. While they may serve a purpose when the students have a hard-copy of the notes in a live lecture, they will most likely be using your notes on a screen this year. It is possible to create notes with gaps for things like equations etc for the students to fill in. To do this you need to add some extra code to the index.Rmd file: ``` {r setup, include=FALSE} library(knitr) knit_engines$set(asis = function(options) { if (options$echo &amp;&amp; options$eval) knit_child(text = options$code) }) ``` Then to “hide” e.g. an equation but still keep the same numbering, edit your equation to the following format: \\begin{equation} ```{asis, echo=FALSE} \\Delta s^2 = \\Delta x_{1}^{2} + \\Delta x_{2}^{2} ``` (\\#eq:dist01) \\end{equation} Here the asis command and back-ticks wrap around only the equation itself, rather than the whole equation object. If you wrap the asis around the \\begin{equation} and \\end{equation} the equation numbering will disappear too. 2.5 Using the titlesec package If you’re using the titlesec latex package you’ll need to add an additional line to the yaml information on your index.Rmd file: subparagraph: yes This should fix any compilation errors related to the titlesec package when you’re producing a pdf output. Source: Stack Overflow "],["intro-markdown.html", "Chapter 3 A quick introduction to Markdown 3.1 What is Markdown? 3.2 Markdown syntax", " Chapter 3 A quick introduction to Markdown 3.1 What is Markdown? Markdown is a lightweight markup language that you can use to add formatting elements to plaintext text documents. markdown.org You can create markdown documents in any text editor that can create plain text files. For making things in bookdown, I prefer to use the RStudio IDE so I have access to the build tools while I’m writing. 3.2 Markdown syntax You may already be familiar with some/all of the markdown syntax from using things like Moodle. A nice markdown cheat sheet can be found here. These are some of the features I use most frequently. In the following examples, the grey boxes with mono-spaced font show the markdown and the green boxes show the rendered output. The “\\” you see in the raw markdown is an escape character to render the #, * etc. as symbols rather than a formatter. 3.2.1 Headings You can make different levels of headings using different numbers of #’s at the start of a line # One \\# for a chapter ## Two \\#\\# for a section ### Three \\#\\#\\# for a subsection Chapter 1  One # for a chapter 1.1  Two ## for a section 1.1.1  Three ### for a subsection More details about chapter and section headings is in Section 4.1 3.2.2 Text formatting You can make text italic using one * or _ at each end of the text. Bold uses two of each. make italics using _one underscore_ or *one star* at each end make bold using __two underscores__ or **two stars** at each end make italics using one underscore or one star at each end make bold using two underscores or two stars at each end 3.2.3 Lists Making lists is easy too! * Bulleted lists * are made by putting * a \\* (asterix) - or a dash (-) - at the start of the line. - You don&#39;t even need to be consistent. - You can make a sub-list by adding 4 spaces before the - - but I&#39;m not sure how many levels this goes to... Bulleted lists are made by putting a * (asterix) or a dash (-) at the start of the line. You don’t even need to be consistent. You can make a sub-list by adding 4 spaces before the - but I’m not sure how many levels this goes to… 1. To make a numbered list 2. you just number things 3. i.e. 1., 2., at the start of a line 7. and it doesn&#39;t matter 4. if your numbers are in the right order 1. or if you keep using 1. the same number To make a numbered list you just number things i.e. 1., 2., at the start of a line and it doesn’t matter if your numbers are in the right order or if you keep using the same number You can also do a) Alphabetical lists a) using lower case letters, A) or using A) upper case letters Alphabetical lists using lower case letters, or using upper case letters or you can 1. mix all of them together a) if that&#39;s how - you like to spend - your time. mix all of them together if that’s how you like to spend your time. If you look at the source code for this section you’ll see that the code to display the headings example doesn’t match the markdown. This was a hacky way to get it to display correctly without messing up the section numbering If you find a solution for how to reset section numbers please let me know, because I’ve spent far too long on Stack Overflow today.↩︎ "],["03-chapters.html", "Chapter 4 Chapters, sections, etc. 4.1 File Structure 4.2 Section labels 4.3 Cross referencing", " Chapter 4 Chapters, sections, etc. 4.1 File Structure Bookdown organises your notes into a book. The main page you see when you open a bookdown page is the index.Rmd file. Each chapter in the book has it’s own markdown file. There are two options for defining the order of your chapters: using numbers in the file name, or specifying the order in the _bookdown.yml file. 4.1.1 Specifying the order in _bookdown.yml The easiest way to organise chapters is to specify the order in the _bookdown.yml file. For this method you don’t need to have the numbers in the file name, and it’s much easier to rearrange things. To specify the order, add an rmd_files section to the _bookdown.yml file and put the file names in the order you want them to appear: rmd_files: - index.Rmd - 01-intro.Rmd - 02-latex-conversion.Rmd - intro-markdown.Rmd - 03-chapters.Rmd ... - 99-references.Rmd You’ll see here that the intro-markdown.Rmd chapter doesn’t have a number at the start. You don’t need them for this method; bookdown will ignore the numbers and render things in your listed order. More details (that you probably won’t need) about how this works are here. Your references chapter should be the last one, otherwise it doesn’t work properly. 4.1.2 Order by filename This is the old method of ordering chapters. If you start from the bookdown template (described in Section 1), you’ll see that the template files all start with a number. Bookdown will put the chapters in numerical order. For example, the following file names would order the chapters as they are in this book: index.Rmd 01-intro.Rmd 02-latex-conversion.Rmd 03-intro-markdown.Rmd 04-chapters.Rmd ... etc I find this works reasonably well if you know beforehand what order you’re going to put things in, but it quickly gets annoying if you decide later on that you want to add a chapter between two existing ones (you’d have to rename all the subsequent chapters), so I recommend using the method in Section 4.1.1. 4.2 Section labels The chapter title and label are given in the first line of the file. # Chapters, sections, etc. {#sec:chapters} The # at the start of the line denotes a chapter heading (see Section 3.2.1). The label is given in {#sec:chapters}. I think bookdown can create its own labels from the chapter/section heading, but it’s easier to cross-reference if you set them yourself. You can make sections using two # at the start of the line: ## Section labels {#sec:sec-lables} Note that the {#sec:label} syntax is still the same - you don’t need to say whether it’s a chapter, section, subsection etc. Subsections are done similarly, with three # at the start of the line. You can change the section heading from “Chapter” to e.g. “Section” by editing the following in the _bookdown.yml file: language: ui: chapter_name: &quot;Section &quot; 4.3 Cross referencing You can reference other chapters, sections etc. throughout the book with the following syntax: Section \\@ref(sec:cross-ref) is this section. Section 4.3 is this section. When cross-referencing, you don’t need the # before sec. That’s only used to define the label. "],["04-figures.html", "Chapter 5 Figures 5.1 Adding figures 5.2 Figure captions 5.3 Figure numbering and referencing", " Chapter 5 Figures 5.1 Adding figures Figures and captions can be included, but the syntax is quite different to LaTeX. Assuming that you would add a figure to a LaTeX document with the following code: \\begin{figure} \\begin{centering} \\includegraphics[width=0.7\\textwidth]{Images/ho-tension.png} \\caption{This is a figure caption.} \\label{fig:ho-plot} \\end{centering} \\end{figure} To include the figure in markdown the syntax is as follows: ``` {r echo=FALSE, ho-plot, out.width=&#39;70%&#39;, fig.show=&#39;hold&#39;, fig.cap=&quot;This is a figure caption.&quot;} knitr::include_graphics(&quot;Images/ho-tension.png&quot;) ``` Figure 5.1: This is a figure caption. Important parts of this command: echo=FALSE prevents the code being used to display the figure being shown. ho-plot is your figure label. out-width is the output width of the figure. fig.cap is the figure caption. knitr::include_graphics gives the location of the image file. 5.2 Figure captions Figure captions are controlled by the fig.cap setting. Your caption should be inside the double quotes. Remember to use \\” to escape any ” characters you may use inside your caption. You can include cross-references and citations inside figure captions. See Sections 5.3, 6.3, and 7.2 for how to label and cross-reference figures, equations, and tables. Citations are covered in Section 8.1. 5.3 Figure numbering and referencing Figures with labels and captions are numbered according to the section (e.g. Fig 5.1 in this case). To reference a figure use the syntax \\@ref(fig:label) where fig:label would be fig:ho-plot in this case. You can cross reference between sections/chapters, so make sure to use unique figure labels. "],["05-equations.html", "Chapter 6 Equations 6.1 Equation syntax 6.2 Equation numbers and labels 6.3 Cross referencing equations 6.4 Maths in captions 6.5 Random tips", " Chapter 6 Equations pre code { white-space: pre-wrap; } 6.1 Equation syntax The syntax for equations is similar (but not identical) to LaTeX. LaTeX code: \\begin{equation} \\label{eqn:friedman} \\left(\\dfrac{\\dot{a}}{a}\\right)^2 + \\dfrac{kc^2}{a^2} = \\dfrac{8\\pi G}{3}\\rho \\end{equation} Rmd code: \\begin{equation} \\left(\\dfrac{\\dot{a}}{a}\\right)^2 + \\dfrac{kc^2}{a^2} = \\dfrac{8\\pi G}{3}\\rho (\\#eq:friedman) \\end{equation} \\[\\begin{equation} \\left(\\dfrac{\\dot{a}}{a}\\right)^2 + \\dfrac{kc^2}{a^2} = \\dfrac{8\\pi G}{3}\\rho \\tag{6.1} \\end{equation}\\] You can also use the latex \\begin{align} ... \\end{align} format for equations. If you’re converting from LaTeX to markdown with pandoc it may convert equations to \\begin{aligned} ... \\end{aligned} which also works. LaTeX subequations and intertext I haven’t been able to get subequations and intertext to work in bookdown. LaTeX equations of the form \\begin{subequations}\\begin{align} \\vec{E} &amp;= \\left( x,t \\right) \\intertext{and in 3 dimensional space as} \\vec{E} &amp;= \\left( x,y,z,t \\right) \\end{align}\\end{subequations} should be written as separate equations with the text between written outside the equation environment, e.g.  \\begin{align} \\vec{E} &amp;= \\left( x,t \\right) \\end{align} and in 3 dimensional space as \\begin{align} \\vec{E} &amp;= \\left( x,y,z,t \\right) \\end{align} 6.2 Equation numbers and labels The syntax for the maths is the same, but the labelling changes. To label and equation add (\\#eq:label) just before end{equation}. Only equations with labels will be numbered. If you don’t want numbers then don’t label the equations, but numbers are helpful. 6.3 Cross referencing equations The syntax for cross-referencing equations is similar to sections and figures, i.e. Eqn. \\@ref(eq:friedman) is the Friedman equation will give “Eqn. (6.1) is the Friedman equation”. 6.4 Maths in captions R markdown gets a bit finicky about maths/symbols in captions. You may need to use two backslashes to escape symbols in figure captions. Example of a finicky caption: ``` {r echo=FALSE, gaussian, out.width=&#39;100%&#39;, fig.show=&#39;hold&#39;, fig.cap=&quot;Gaussian uncertainties. If we measure a value $x$ for a variable that has a true value $\\\\langle x \\\\rangle$ and uncertainty $\\\\sigma$, there is a 68.3% probability that $x$ will be within $\\\\langle x \\\\rangle \\\\pm 1\\\\sigma$. There&#39;s a 95.4% probability of $x$ being within $\\\\langle x \\\\rangle \\\\pm 2\\\\sigma$, and 99.7% of $x$ being within $\\\\langle x \\\\rangle \\\\pm 3\\\\sigma$.&quot;} knitr::include_graphics(&quot;Images/normal-curve.png&quot;) ``` Figure 6.1: Gaussian uncertainties. If we measure a value \\(x\\) for a variable that has a true value \\(\\langle x \\rangle\\) and uncertainty \\(\\sigma\\), there is a 68.3% probability that \\(x\\) will be within \\(\\langle x \\rangle \\pm 1\\sigma\\). There’s a 95.4% probability of \\(x\\) being within \\(\\langle x \\rangle \\pm 2\\sigma\\), and 99.7% of \\(x\\) being within \\(\\langle x \\rangle \\pm 3\\sigma\\). 6.5 Random tips Angstrom symbol: Use $\\unicode{x0212B}$ rather than $\\AA$ to get \\(\\unicode{x0212B}\\). You can ddd \\newcommand{\\AA}{\\unicode{x0212B}} to index.Rmd file before the main text starts to make $\\AA$ work. "],["06-tables.html", "Chapter 7 Tables 7.1 Markdown table generator 7.2 Table syntax 7.3 Fancy tables", " Chapter 7 Tables 7.1 Markdown table generator If you’re making a new table from scratch then the Markdown Table Generator (https://www.tablesgenerator.com/markdown_tables) is a handy tool. 7.2 Table syntax Tables are a bit more simple in markdown than in latex. I haven’t played around with complex tables much, but it’s straightforward to make a basic one. Example table: Table: (\\#tab:planck-model) Base $\\Lambda$CDM cosmological parameters from @Planck18. | Parameter | Best fit value | Uncertainty | |:--------------------|----------:|----------:| | $\\Omega_{b}h^2$ | 0.02233 | 0.00015 | | $\\Omega_{c}h^2$ | 0.1198 | 0.0012 | | $\\Omega_{m}h^2$ | 0.1428 | 0.0011 | | $H_0$ | 67.37 | 0.54 | | $\\Omega_{m}$ | 0.3147 | 0.0074 | | Age (Gyr) | 13.801 | 0.024 | | $z_{re}$ | 7.64 | 0.74 | | 100$\\theta_{*}$ | 1.04108 | 0.00031 | Important things about tables: Captions go at the top and should include the label definition. Label syntax is Table: (\\#tab:table-name) Columns are delimited by | Justification given by the colons and dashes in the line under the header row. Table 7.1: Base \\(\\Lambda\\)CDM cosmological parameters from Planck Collaboration (2018). Parameter Best fit value Uncertainty \\(\\Omega_{b}h^2\\) 0.02233 0.00015 \\(\\Omega_{c}h^2\\) 0.1198 0.0012 \\(\\Omega_{m}h^2\\) 0.1428 0.0011 \\(H_0\\) 67.37 0.54 \\(\\Omega_{m}\\) 0.3147 0.0074 Age (Gyr) 13.801 0.024 \\(z_{re}\\) 7.64 0.74 100\\(\\theta_{*}\\) 1.04108 0.00031 7.3 Fancy tables The kableExtra package is useful if you want to make fancier tables with things like grouped columns. The documentation is here (it’s a bit sparse…) but I’m including an example here to save you the time googling. library(kableExtra) ## read the table in from a file df &lt;- read.csv(&quot;lj_table.csv&quot;, header = TRUE, row.names = &quot;Element&quot;) ## changing the names of my column headings. R starts ## counting at 1 names(df)[1] &lt;- paste(&quot;$10^{-21}$ J&quot;) names(df)[2] &lt;- paste(&quot;meV&quot;) names(df)[3] &lt;- paste(&quot;$10^{-10}$ m&quot;) ## fancy formatting df %&gt;% kbl(caption = &quot;Lennerd-Jones potentials, apparently. Shamelessly stolen from Sloan&#39;s lecture notes.&quot;, align = c(&quot;l&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;)) %&gt;% ## only a little table, so stopping it being the full ## width of the page kable_styling(full_width = F) %&gt;% ## Grouping some columns add_header_above(c(Element = 1, `$\\\\epsilon$` = 2, `$\\\\sigma$` = 1, `$r_0$` = 1), align = c(&quot;l&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;)) Table 7.2: Lennerd-Jones potentials, apparently. Shamelessly stolen from Sloan’s lecture notes. Element \\(\\epsilon\\) \\(\\sigma\\) \\(r_0\\) \\(10^{-21}\\) J meV \\(10^{-10}\\) m Å He 0.14 0.9 2.56 3.12 Ne 0.49 3.1 2.75 3.36 Ar 1.70 10.6 3.40 4.15 To get this to show your table, include the code above inside an r code chunk. The echo=FALSE part hides the code but still displays the result (which is probably what you want). ``` {r echo=FALSE} ## table code goes here ``` References "],["07-referencing.html", "Chapter 8 Referencing 8.1 Adding citations 8.2 Bibliography files 8.3 Reference style", " Chapter 8 Referencing 8.1 Adding citations You can reference publications etc using the following syntax: @bibcode where bibcode is the bibcode for the entry in your bib file (see Sec. 8.2). This will give the equivalent of the LaTeX \\citet{} command. Example: @2016Scowcroft showed that the SMC is a very elongated galaxy. Scowcroft et al. (2016) showed that the SMC is a very elongated galaxy. For \\citep{}, just put the citation in square brackets. The first observations of SMC Cepheids were taken over 100 years ago [@1912Leavitt]. The first observations of SMC Cepheids were taken over 100 years ago (Leavitt &amp; Pickering 1912). 8.2 Bibliography files Assuming you’re using natbib style references you can pass the same bib file to bookdown. Example bib file entry: @ARTICLE{1912Leavitt, author = {{Leavitt}, Henrietta S. and {Pickering}, Edward C.}, title = &quot;{Periods of 25 Variable Stars in the Small Magellanic Cloud.}&quot;, journal = {Harvard College Observatory Circular}, year = &quot;1912&quot;, volume = {173}, pages = {1}, } 8.3 Reference style The referencing style is controlled in the index.Rmd file. At the top of this file you’ll find the section that defines things like the book title, output format etc. The following lines are where you define the bib file names and referencing format. You can have multiple bib files. bibliography: [book.bib, packages.bib] csl: apj.csl link-citations: yes The bibliography: line points to your bib file. The csl: line points to your style file. This book uses the ApJ style. Additional style files (e.g. PRL etc.) can be downloaded from zotero. link-citations: yes creates links from the citations in the text to the reference list at the end of the chapter. Any chapter that includes references will have a the reference list at the end. You can also include a separate reference list for the whole document. To make sure this goes right at the end I usually name my file 99-references.Rmd. If you specify the ordering as described in Section 4.1.1 you need to make sure that the reference chapter is the last one in the list. The references file should contain the following text: `r if (knitr::is_html_output()) &#39;# References {-}&#39;` This will create an un-numbered section at the end of the book called ‘References’ that has the full reference list. References "],["08-publishing.html", "Chapter 9 Publishing 9.1 Compiling the book 9.2 Publishing with github pages 9.3 Publishing to Moodle", " Chapter 9 Publishing 9.1 Compiling the book To compile the book, press the ‘Build Book’ button in R Studio. You may need to press the arrow on the button and select bookdown::gitbook the first time you do this. Figure 9.1: Build book button This compiles all the markdown to create html files for the book. The output files should be in the _book folder. 9.2 Publishing with github pages I use github pages to publish my notes. The following assumes you are already using github to store your files. TODO: Can add instructions for this part if needed. Once you have your book on github, create a new branch called gh-pages. This should enable the gh-pages setting in the repo. Now clone the gh-pages branch into a directory called book-output git clone -b gh-pages $repo-path book-output where $repo-path is the location of the repository on github, e.g. https://github.com/your_user_name/lecture_notes.git Then you want to copy all the output files into this directory and push it to the gh-pages branch. cd book-output cp -r ../_book/* ./ git add --all * git commit -m &quot;Update the book&quot; || true git push -q origin gh-pages Your pretty lecture notes should now be online! You should find them at github_username.github.io/repo_name - or check the setting page of the repository. The address will be given in the github pages section. 9.3 Publishing to Moodle To be written soon…. "],["inprogress.html", "Things I should probably add to this guide at some point HTML output PDF output Adding new styles Publishing to mooodle", " Things I should probably add to this guide at some point HTML output editing css what files? where? how? PDF output latex stuff? latex templates? is this even a good idea? Adding new styles adding div things to the css other stuff? Publishing to mooodle quick way to update individual files. Suggestions for things that should be added are welcome. "],["99-references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
